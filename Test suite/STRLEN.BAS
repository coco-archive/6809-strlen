10 REM STRLEN TEST PROGRAM
20 REM  BY RICHARD JOHN
30 REM   FOSTER CAVELL
40 REM     (C) 2017
40 REM
50 REM LOAD STRLEN.BIN INTO
60 REM   THE MEMORY LOCATION
70 REM   GIVEN AT LINE 220
80 REM LOAD STRLEN-TEST.BIN
90 REM   INTO THE MEMORY
100 REM  LOCATION GIVEN AT
100 REM  LINE 230
110 REM THEN JUST RUN THIS
120 REM  PROGRAM.
130 REM
200 LET CODEPTR = &H2FFC
210 LET ARG     = &H2FFE
220 LET STRLEN  = &H3000
230 LET TEST    = &H3100
240 LET STR     = &H3200
290 REM
300 REM EACH OF THESE STRINGS
310 REM  WILL BE MEASURED
320 REM
330 A$ = "HELLO, WORLD!"
340 B$ = "1234567890"
350 C$ = ""
360 D$ = "THIS IS A REALLY LONG STRING.  I AM NOT KIDDING.  IT IS REALLY LONG."
390 REM
400 REM MEASURE EACH STRING
410 REM
420 X$ = A$ : GOSUB 500
430 X$ = B$ : GOSUB 500
440 X$ = C$ : GOSUB 500
450 X$ = D$ : GOSUB 500
460 GOTO 1000
470 REM
480 REM
490 REM
500 REM SUBROUTINE TO MEASURE
510 REM  STRING LENGTH
520 REM  INPUT IS IN X$
530 REM
540 FOR I = 0 TO (LEN(X$) - 1)
550 POKE (STR + I),                  ASC(MID$(X$,I + 1,1))
560 NEXT I
590 REM
600 POKE (STR + LEN(X$)), 0
610 REM
700 POKE PC,                         INT(ROUTINE / 256)
710 LET I = ROUTINE : GOSUB 900
720 POKE (PC + 1), I
730 POKE PS,                         INT(STR / 256)
740 LET I = STR : GOSUB 900
750 POKE (PS + 1), I
760 PRINT "THE STRING IS : ";        X$
770 EXEC TEST
780 LET LENGTH = PEEK(PS)            * 256 + PEEK(PS + 1)
800 PRINT "THE CALCULATED";
810 PRINT " LENGTH IS : "
820 PRINT "(BASIC) "; LEN(X$)
830 PRINT "(ASM)   "; LENGTH
840 RETURN
890 REM
900 REM GET THE LOW BYTE
910 REM
920 REM VALUE PASSED IN I
930 IF I < 256 THEN GOTO 950
940 I = I - 256 : GOTO 930
950 RETURN
990 REM
1000 END
